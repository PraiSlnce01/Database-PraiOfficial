<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Nomor ke Database</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', sans-serif;
      height: 100vh;
      overflow: hidden;
    }
    video.bg-video {
      position: fixed;
      right: 0;
      bottom: 0;
      min-width: 100%;
      min-height: 100%;
      object-fit: cover;
      z-index: -1;
    }
    .form-container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(255, 255, 255, 0.85);
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      box-shadow: 0 0 20px rgba(0,0,0,0.4);
    }
    input {
      width: 90%;
      padding: 12px;
      margin-top: 10px;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      margin-top: 15px;
      padding: 12px 25px;
      font-size: 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    .message {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>

  <!-- Background Video -->
  <video class="bg-video" autoplay muted loop>
    <source src="https://files.catbox.moe/3jyser.mp4" type="video/mp4">
    PraiOfficial | Tzy, Database number.
  </video>

  <div class="form-container">
    <h2>Database PraiOfficial V3.0.1</h2>
    <input type="text" id="nomorInput" placeholder="Masukkan Nomor (e.g. 628xxxx)">
    <button onclick="submitNomor()">Kirim</button>
    <div class="message" id="message"></div>
  </div>

  <script>
    async function submitNomor() {
      const nomor = document.getElementById('nomorInput').value.trim();
      const message = document.getElementById('message');

      if (!nomor) {
        message.textContent = 'Nomor tidak boleh kosong.';
        message.style.color = 'red';
        return;
      }

      // --- Konfigurasi GitHub ---
      const repoOwner = 'PraiSlnce01';     // Ganti
      const repoName = 'prai.js';     // Ganti
      const filePath = 'userdatabase'; // Lokasi file di repo
      const branch = 'main';            // Atur sesuai branch-mu
      const token = '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'; // Ganti token GitHub kamu

      const apiUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;

      // Ambil file database.json yang ada di repo
      const response = await fetch(apiUrl, {
        headers: {
          Authorization: `Bearer ${token}`,
          Accept: 'application/vnd.github.v3+json'
        }
      });

      if (!response.ok) {
        message.textContent = 'Gagal mengambil database.json';
        message.style.color = 'red';
        return;
      }

      const data = await response.json();
      const content = atob(data.content);
      let json = [];

      try {
        json = JSON.parse(content);
      } catch (e) {
        json = [];
      }

      json.push({ nomor, waktu: new Date().toISOString() });

      const newContent = btoa(JSON.stringify(json, null, 2));

      // Simpan kembali file ke GitHub
      const update = await fetch(apiUrl, {
        method: 'PUT',
        headers: {
          Authorization: `Bearer ${token}`,
          Accept: 'application/vnd.github.v3+json'
        },
        body: JSON.stringify({
          message: `Menambahkan nomor ${nomor}`,
          content: newContent,
          sha: data.sha,
          branch: branch
        })
      });

      if (update.ok) {
        message.textContent = 'Nomor berhasil ditambahkan!';
        message.style.color = 'green';
        document.getElementById('nomorInput').value = '';
      } else {
        message.textContent = 'Gagal menyimpan ke database.';
        message.style.color = 'red';
      }
    }
  </script>
</body>
</html>